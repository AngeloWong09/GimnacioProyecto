

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bienvenido a GYM FAST FORCE</title>
    <link rel="stylesheet" href="styles.css" />
</head>
<body>
    <h1 class="title">Bienvenido a GYM FAST FORCE</h1>

    <h2>Inicio de sesión 1 (ID)</h2>
    <form id="loginForm1" onsubmit="return login1(event)">
        <div class="form-group">
            <label for="user">Usuario:</label>
            <input type="text" id="user" required />
        </div>
        <div class="form-group">
            <label for="password">Contraseña:</label>
            <input type="password" id="password" required />
        </div>
        <button type="submit">Login 1</button>
    </form>

    <h2>Inicio de sesión 2 (Nombre y Contraseña)</h2>
    <form id="loginForm2" onsubmit="return login2(event)">
        <div class="form-group">
            <label for="name">Nombre:</label>
            <input type="text" id="name" required />
        </div>
        <div class="form-group">
            <label for="password2">Contraseña:</label>
            <input type="password" id="password2" required />
        </div>
        <button type="submit">Login 2</button>
    </form>

    <h2>Mostrar Archivo CSV</h2>
    <div>
        <input type="file" id="csvFileInput" accept=".csv" onchange="procesarCSV(event)" />
    </div>
    <br />

    <h2>Notificación</h2>
    <div id="notification" style="color: green;"></div>

    <script>
        let datosCSV = {
            administrador: [],
            entrenador: [],
            cliente: []
        };

        // Función de login 1 (ID)
        function login1(event) {
            event.preventDefault();
            var username = document.getElementById("user").value;
            var password = document.getElementById("password").value;

            if (username === "Leinix" && password === "0") {
                window.location.href = "/Administrador";  // Redirige al Administrador.razor
            } else if (username === "Ana" && password === "0") {
                window.location.href = "/Cliente";
            } else if (username === "Tobi" && password === "0") {
                window.location.href = "/Entrenador";
            } else {
                alert("Usuario o contraseña incorrectos.");
            }
        }

        // Función de login 2 (Nombre y Contraseña)
        function login2(event) {
            event.preventDefault();
            var name = document.getElementById("name").value;
            var password2 = document.getElementById("password2").value;

            // Comprobar si el nombre y la contraseña coinciden con el archivo CSV cargado
            const admin = datosCSV.administrador.find(fila => fila[0] === name && fila[1] === password2);
            const entrenador = datosCSV.entrenador.find(fila => fila[0] === name && fila[1] === password2);
            const cliente = datosCSV.cliente.find(fila => fila[0] === name && fila[1] === password2);

            if (admin) {
                mostrarNotificacion("Éxito! Las credenciales coinciden.");
                window.location.href = "/Administrador";  // Redirige a Administrador.razor
            } else if (entrenador) {
                mostrarNotificacion("Éxito! Las credenciales coinciden.");
                window.location.href = "/Entrenador";  // Redirige a Entrenador.razor
            } else if (cliente) {
                mostrarNotificacion("Éxito! Las credenciales coinciden.");
                window.location.href = "/Cliente";  // Redirige a Cliente.razor
            } else {
                mostrarNotificacion("Las credenciales no coinciden.");
            }
        }

        // Procesar archivo CSV para Administrador, Cliente y Entrenador
        function procesarCSV(event) {
            const archivo = event.target.files[0];
            if (!archivo) {
                alert("Por favor seleccione un archivo CSV.");
                return;
            }

            // Usar FileReader asíncrono
            const lector = new FileReader();
            lector.onload = function (e) {
                const contenido = e.target.result;
                const lineas = contenido.split("\n").filter(linea => linea.trim() !== "");  // Elimina líneas vacías

                // Log para verificar la cabecera
                console.log("Primera línea del archivo CSV:", lineas[0]);

                let tipoArchivo = "";  // Para detectar si es de Administrador, Entrenador o Cliente

                // Verificar el tipo de archivo por la estructura
                if (lineas[0].startsWith("Usuario;Contraseña;Nombre;Apellido;Id")) {
                    tipoArchivo = "administrador";
                } else if (lineas[0].startsWith("Usuario;Contraseña;Nombre;Apellido;Id;Puntos fuertes")) {
                    tipoArchivo = "entrenador";
                } else if (lineas[0].startsWith("Usuario;Contraseña;Nombre;Apellidos;ID")) {
                    tipoArchivo = "cliente";
                }

                // Log para verificar qué tipo de archivo se ha detectado
                console.log("Tipo de archivo detectado:", tipoArchivo);

                if (tipoArchivo) {
                    datosCSV[tipoArchivo] = lineas.map(linea => linea.split(";"));
                    mostrarNotificacion("Archivo CSV cargado correctamente.");
                } else {
                    mostrarNotificacion("El archivo no tiene un formato válido.");
                }
            };

            lector.onerror = function () {
                alert("Hubo un problema al leer el archivo.");
            };

            lector.readAsText(archivo);
        }

        // Mostrar notificaciones en la interfaz
        function mostrarNotificacion(mensaje) {
            const notificationDiv = document.getElementById("notification");
            notificationDiv.textContent = mensaje;
        }
    </script>
</body>
</html>

