
@page "/EntrenadorEmitirFacturas"

<!DOCTYPE html>
<html>
<head>
    <title>Bienvenido a GYM FAST FORCE!</title>
    <link rel="stylesheet" href="styles.css" />
</head>
<body>
    <h1 class="title">Bienvenido a GYM FAST FORCE</h1>

    <h2>Administrar Clases</h2>

    <!-- Botón para agregar nueva clase y guardar CSV -->
    <div>
        <button onclick="agregarClase()">Agregar Nueva Clase</button>
        <button onclick="guardarCSV()">Guardar Tabla como CSV</button>
    </div>
    <br />

    <h3>Agregar Clase</h3>
    <div>
        <label for="idEntrenador">ID Entrenador:</label>
        <input type="text" id="idEntrenador" placeholder="Ej: 1237894">

        <label for="clase">Clase:</label>
        <input type="text" id="clase" placeholder="Ej: Zumba">

        <label for="fecha">Fecha:</label>
        <input type="date" id="fecha">

        <label for="horario">Horario:</label>
        <input type="time" id="horario">

        <label for="precio">Precio Clase:</label>
        <input type="text" id="precio" placeholder="Ej: ?2 500">
    </div>
    <br />

    <!-- Tabla para mostrar las clases ingresadas -->
    <h3>Clases Ingresadas</h3>
    <table id="clasesTable" border="1" style="width: 100%; border-collapse: collapse;">
        <thead>
            <tr>
                <th>ID Clase</th>
                <th>ID Entrenador</th>
                <th>Clase</th>
                <th>Fecha</th>
                <th>Horario</th>
                <th>Precio Clase</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody id="clasesTableBody">
            <!-- Las clases ingresadas se agregarán aquí -->
        </tbody>
    </table>

    <script>
        let clases = []; // Para almacenar las clases ingresadas

        // Función para generar un ID de clase aleatorio a partir de 497670
        function generarIdClase() {
            return 497670 + Math.floor(Math.random() * 1000); // Incrementar aleatoriamente en base a 497670
        }

        // Función para agregar una nueva clase a la lista
        function agregarClase() {
            const idEntrenador = document.getElementById('idEntrenador').value.trim();
            const clase = document.getElementById('clase').value.trim();
            const fecha = document.getElementById('fecha').value.trim();
            const horario = document.getElementById('horario').value.trim();
            const precio = document.getElementById('precio').value.trim();

            if (!idEntrenador || !clase || !fecha || !horario || !precio) {
                alert("Por favor, llena todos los campos.");
                return;
            }

            const idClase = generarIdClase(); // Generar un ID para la clase

            // Agregar clase al array
            clases.push({
                idClase: idClase,
                idEntrenador: idEntrenador,
                clase: clase,
                fecha: fecha,
                horario: horario,
                precio: precio
            });

            // Mostrar la clase en la tabla
            mostrarClases();
        }

        // Función para mostrar todas las clases en la tabla
        function mostrarClases() {
            const tablaBody = document.getElementById('clasesTableBody');
            tablaBody.innerHTML = ""; // Limpiar la tabla

            clases.forEach((clase) => {
                const fila = document.createElement("tr");

                fila.innerHTML = `
                            <td>${clase.idClase}</td>
                            <td>${clase.idEntrenador}</td>
                            <td>${clase.clase}</td>
                            <td>${clase.fecha}</td>
                            <td>${clase.horario}</td>
                            <td>${clase.precio}</td>
                            <td><button onclick="editarClase(${clase.idClase})">Editar</button></td>
                        `;

                tablaBody.appendChild(fila);
            });
        }

        // Función para editar una clase
        function editarClase(idClase) {
            const clase = clases.find(c => c.idClase === idClase);
            if (clase) {
                document.getElementById('idEntrenador').value = clase.idEntrenador;
                document.getElementById('clase').value = clase.clase;
                document.getElementById('fecha').value = clase.fecha;
                document.getElementById('horario').value = clase.horario;
                document.getElementById('precio').value = clase.precio;
            }
        }

        // Función para guardar los datos de las clases como archivo CSV
        function guardarCSV() {
            let csvContent = "IDClase,IDEntrenador,Clase,Fecha,Horario,PrecioClase\n"; // Añadimos los encabezados

            clases.forEach(clase => {
                csvContent += `${clase.idClase},${clase.idEntrenador},${clase.clase},${clase.fecha},${clase.horario},${clase.precio}\n`;
            });

            // Crear un archivo blob y descargarlo
            const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = "Clases_guardadas.csv";
            link.click();
        }
    </script>
</body>
</html>
